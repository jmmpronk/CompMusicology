---
title: "What makes a song timeless?"
author: "Jonas Pronk"
date: "`r Sys.Date()`"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(spotifyr)
library(dplyr)
library(ggthemes)
library(pals)
```

```{r data import, include=FALSE}
the_beatles <- get_playlist_audio_features("", "37i9dQZF1DZ06evO2iBPiw")

led_zeppelin <- get_playlist_audio_features("", "37i9dQZF1DZ06evO1NyWWI")

queen <- get_playlist_audio_features("", "37i9dQZF1DZ06evO0ENBD2")

pink_floyd <- get_playlist_audio_features("", "37i9dQZF1DZ06evO07zaak")

the_rolling_stones <- get_playlist_audio_features("", "37i9dQZF1DZ06evO19s0CZ")

eagles <- get_playlist_audio_features("", "37i9dQZF1DZ06evO0jXJRu")

aerosmith <- get_playlist_audio_features("", "37i9dQZF1DZ06evO4x3X2w")

bon_jovi <- get_playlist_audio_features("", "37i9dQZF1DZ06evO3154GY")

the_doors <- get_playlist_audio_features("", "37i9dQZF1DZ06evO19UBIk")

lynyrd_skynyrd <- get_playlist_audio_features("", "37i9dQZF1DZ06evO2ObHwc")

uk <-
  bind_rows(
    the_beatles |> mutate(band = "The Beatles"),
    led_zeppelin |> mutate(band = "Led Zeppelin"),
    queen |> mutate(band = "Queen"),
    pink_floyd |> mutate(band = "Pink Floyd"),
    the_rolling_stones |> mutate(band = "The Rolling Stones")
  )

us <-
  bind_rows(
    eagles |> mutate(band = "Eagles"),
    aerosmith |> mutate(band = "Aerosmith"),
    bon_jovi |> mutate(band = "Bon Jovi"),
    the_doors |> mutate(band = "The Doors"),
    lynyrd_skynyrd |> mutate(band = "Lynyrd Skynyrd")
  )

corpus <-
  bind_rows(
    uk |> mutate(country = "UK"),
    us |> mutate(country = "US")
  )
```

### Computational Musicology

This is the repository that I will be using during the course Computational Musicology, in which the analysis into my corpus will be visible. My corpus is made up of popular rock music from the 70s from the UK and the USA. To compare the two regions I made a selection of five British and five American bands who were popular during this time period. This selection came down to The Beatles, The Rolling stones, Queen, Led Zeppelin and Pink Floyd for the British bands, and Eagles, Aerosmith, Bon Jovi, The Doors and Lynyrd Skynyrd for the American bands. During this course I hope to dive deeper into the effect that the geographic region had on the genre of rock. To achieve this I will be looking at elements such as acousticness, valence, energy, rhythm, and timbre.

I choose this corpus because a lot of my music interest lies within this time period. I think that specifically rock music is an interesting genre to look at, because it peaks during this time period. To produce representative data I have chosen one specific genre, as not to compare different genres. As I have only included the most popular bands, many influential and important rock bands will be missing in this corpus.

### Typical/Atypical Tracks

Using the data from the corpus, I've identified a few outliers. Of all the songs in the corpus there were only two songs that scored lower than 0.1 on both energy and valence, those songs were the Pink Floyd songs "Another Brick in the Wall, Pt. 1" and "One of the Few". As for american outliers, the Aerosmith song "Young Lust" scores very high on energy and low on valence, something which goes in against the overall trend.


### Visualizations

```{r Acousticness, echo=FALSE}
count_group <- data.frame(user=factor(rep(1:50, 2)), 
                          count=sample(100, 100, replace=T), 
                          group=factor(rep(LETTERS[1:20], 5)))

library(RColorBrewer)
cols <- colorRampPalette(brewer.pal(9, "Set1"))
ngroups <- length(unique(count_group$group))


corpus |>
  ggplot(aes(x = acousticness, fill = band)) +
  geom_histogram(aes(y = ..density..), binwidth = 0.1) +
  facet_wrap(~country) + scale_fill_manual(values = cols(ngroups))
```
***
```{r EnergyValence, echo=FALSE}
corpus |> ggplot(aes(x = valence, y = energy, fill = country, color = country)) + geom_point(alpha = 0.6, shape = 21, stroke = 1) + theme_tufte() + xlim(0, 1) + ylim(0, 1) + geom_smooth()
```

